-- codigo para borrar tablas para pruebas
-- respetando la dependencia

--DROP TABLE IF EXISTS tmodulo;
--DROP TABLE IF EXISTS tsdem;
--DROP TABLE IF EXISTS thogar;
--DROP TABLE IF EXISTS tvivienda;
--DROP TABLE IF EXISTS municipio;
--DROP TABLE IF EXISTS entidad;


--crear tabla de entidad federativa

CREATE TABLE entidad(
    cve_ent CHAR(2) PRIMARY KEY,
    nom_ent VARCHAR(100) NOT NULL
);

--crear tabla de municipio relacionada a entidad

CREATE TABLE municipio(
    ent_mun     CHAR(5) PRIMARY KEY,
    cve_ent     CHAR(2) NOT NULL,
    cve_mun     CHAR(3) NOT NULL,
    nom_mun     VARCHAR(100) NOT NULL,
    lat_decimal DOUBLE PRECISION,
    lon_decimal DOUBLE PRECISION,
    altitud     NUMERIC,
    cve_carta   VARCHAR(100),

    CONSTRAINT fk_municipio_entidad 
        FOREIGN KEY (cve_ent)
        REFERENCES entidad(cve_ent)
);

--crear tabla de vivienda que apunta a municipio

CREATE TABLE tvivienda(
	llaveviv VARCHAR(100) PRIMARY KEY,
	p1_1	 NUMERIC,
	p1_2	 NUMERIC,
	p1_3	 NUMERIC,
	p1_4_01	 CHAR(1),
	p1_4_02	 CHAR(1),
	p1_4_03	 CHAR(1),
	p1_4_04	 CHAR(1),
	p1_4_05  CHAR(1),
	p1_4_06	 CHAR(1),
	p1_4_07	 CHAR(1),
	p1_4_08	 CHAR(1),
	p1_4_09	 CHAR(1),
	p1_4_10	 CHAR(1),
	p1_5	 CHAR(1),
	p1_6	 CHAR(1),
	p1_7	 CHAR(1),
	p1_8_1	 CHAR(1),
	p1_8_2	 CHAR(1),
	p1_8_3	 CHAR(1),
	p1_8_4	 CHAR(1),
	p1_8_5	 CHAR(1),
	p1_9	 CHAR(1),
	p1_10	 CHAR(1),
	p2_1	 NUMERIC,
	p2_2	 CHAR(1),
	p2_3	 NUMERIC,
	upm	 VARCHAR(100),
	viv_sel	 CHAR(2),
	ent	 CHAR(2),
	mun	 CHAR(3),
	tloc	 CHAR(1),
	region	 CHAR(1),
	fac_viv	 NUMERIC,
	upm_dis	 VARCHAR(100),
	est_dis	 VARCHAR(100),
	ent_mun  CHAR(5) NOT NULL,

	CONSTRAINT fk_vivienda_municipio 
       		FOREIGN KEY (ent_mun)
       		REFERENCES municipio(ent_mun)
);

--crear tabla hogar que apunta a vivienda

CREATE TABLE thogar(
	llavehog VARCHAR(100) PRIMARY KEY,
	llaveviv VARCHAR(100) NOT NULL,
	p4_1_1	CHAR(1),
	p4_1_2	CHAR(1),
	p4_1_3	CHAR(1),
	p4_1_4	CHAR(1),
	p4_1_5	CHAR(1),
	p4_1_6	CHAR(1),
	p4_1_7	CHAR(1),
	p4_1_8	CHAR(1),
	p4_1_9	CHAR(1),
	p4_2	NUMERIC,
	p4_3	CHAR(2),
	filtro_s4_1 CHAR(1),
	p4_4_1	CHAR(1),
	p4_4_2	CHAR(1),
	p4_5_1	CHAR(1),
	p4_5_2	CHAR(1),
	p4_5_3	CHAR(1),
	p4_5_4	CHAR(1),
	p4_6_1	CHAR(1),
	p4_6_2	CHAR(1),
	p4_6_3	CHAR(1),
	p4_6_4	CHAR(1),
	p4_6_5	CHAR(1),
	p4_7_1	CHAR(1),
	p4_8_1	CHAR(1),
	p4_7_2	CHAR(1),
	p4_8_2	CHAR(1),
	p4_7_3	CHAR(1),
	p4_8_3	CHAR(1),
	p4_7_4	CHAR(1),
	p4_8_4	CHAR(1),
	p4_9_1	CHAR(1),
	p4_9_2	CHAR(1),
	p4_9_3	CHAR(1),
	p4_9_4	CHAR(1),
	p4_9_5	CHAR(1),
	p4_9_6	CHAR(1),
	p4_10_1	CHAR(1),
	p4_10_2	CHAR(1),
	p4_10_3	CHAR(1),
	p4_10_4	CHAR(1),
	p4_10_5	CHAR(1),
	p4_10_6	CHAR(1),
	upm	VARCHAR(100),
	viv_sel	CHAR(2),
	hogar	CHAR(1),
	ent	CHAR(2),
	mun	CHAR(3),
	tloc	CHAR(1),
	region	CHAR(1),
	fac_hog	NUMERIC,
	upm_dis	VARCHAR(100),
	est_dis	VARCHAR(100),
	CONSTRAINT fk_hogar_vivienda 
       		FOREIGN KEY (llaveviv)
       		REFERENCES tvivienda(llaveviv)

);

--crar tabla sociodemografia que apunta hogar y a vivienda

CREATE TABLE tsdem(
	llavesde VARCHAR(100) PRIMARY KEY,
	llaveviv VARCHAR(100) NOT NULL,
	llavehog VARCHAR(100) NOT NULL,
	paren	CHAR(1),
	sexo	CHAR(1),
	edad	CHAR(2),
	p3_6_1	CHAR(2),
	p3_6_2	CHAR(2),
	p3_6_3	CHAR(1),
	p3_7	CHAR(1),
	niv	CHAR(2),
	gra	CHAR(1),
	p3_9	CHAR(1),
	p3_10	CHAR(1),
	upm	VARCHAR(100),
	viv_sel	CHAR(2),
	hogar	CHAR(1),
	n_ren	CHAR(2),
	ent	CHAR(2),
	mun	CHAR(3),
	tloc	CHAR(1),
	region	CHAR(1),
	fac_hog	NUMERIC,
	upm_dis	VARCHAR(100),
	est_dis	VARCHAR(100),
	CONSTRAINT fk_sdem_vivienda 
       		FOREIGN KEY (llaveviv)
       		REFERENCES tvivienda(llaveviv),

	CONSTRAINT fk_sdem_hogar 
       		FOREIGN KEY (llavehog)
       		REFERENCES thogar(llavehog)

);

--crear tabla modulo que apunta a hogar y a modulo

CREATE TABLE tmodulo(
	llavemod VARCHAR(100) PRIMARY KEY,
	llaveviv VARCHAR(100) NOT NULL,
	llavehog VARCHAR(100) NOT NULL,
	edad_v	CHAR(2),
	filtro_s5_1 CHAR(1),
	p5_1	CHAR(1),
	p5_2_1	CHAR(1),
	p5_2_2	CHAR(1),
	p5_2_3	CHAR(1),
	p5_2_4	CHAR(1),
	p5_2_5	CHAR(1),
	p5_2_6	CHAR(1),
	p5_2_7	CHAR(1),
	p5_2_8	CHAR(1),
	p5_3	CHAR(1),
	p5_4	CHAR(1),
	p5_4a	CHAR(2),
	p5_5	CHAR(1),
	p5_6	CHAR(1),
	p5_7	CHAR(1),
	p5_8	NUMERIC,
	p5_9_1	CHAR(1),
	p5_9_2	NUMERIC,
	p5_10_1	CHAR(1),
	p5_10_2	NUMERIC,
	p5_11	CHAR(1),
	filtro_s5_2 CHAR(1),
	p5_12	CHAR(1),
	filtro_s5_3 CHAR(1),
	p5_13	CHAR(1),
	p5_14	CHAR(1),
	p5_15	CHAR(1),
	p5_16	CHAR(1),
	p5_17	CHAR(1),
	p5_18_1	CHAR(1),
	p5_18_2	CHAR(1),
	p5_18_3	CHAR(1),
	p5_18_4	CHAR(1),
	p5_18_5	CHAR(1),
	p5_18_6	CHAR(1),
	p5_18_7	CHAR(1),
	p5_19	NUMERIC,
	p5_19a	CHAR(1),
	p5_20	CHAR(1),
	filtro_s5_3_1 CHAR(1),
	p5_21	NUMERIC,
	p5_22	NUMERIC,
	filtro_s5_4 CHAR(1),
	p5_23_1	CHAR(1),
	p5_23_2	CHAR(1),
	p5_23_3	CHAR(1),
	p5_23_4	CHAR(1),
	p5_23_5	CHAR(1),
	p5_23_6	CHAR(1),
	p5_23_7	CHAR(1),
	p5_23_8	CHAR(1),
	p5_23_9	CHAR(1),
	p6_1_1	CHAR(1),
	p6_1_2	CHAR(1),
	p6_1_3	CHAR(1),
	p6_1_4	CHAR(1),
	p6_1_5	CHAR(1),
	p6_1_6	CHAR(1),
	p6_2_01	CHAR(1),
	p6_2_02	CHAR(1),
	p6_2_03	CHAR(1),
	p6_2_04	CHAR(1),
	p6_2_05	CHAR(1),
	p6_2_06	CHAR(1),
	p6_2_07	CHAR(1),
	p6_2_08	CHAR(1),
	p6_2_09	CHAR(1),
	p6_2_10	CHAR(1),
	p6_3	CHAR(1),
	filtro_s6_1 CHAR(1),
	p6_4	CHAR(1),
	p6_5_1	CHAR(1),
	p6_5_2	CHAR(1),
	p6_5_3	CHAR(1),
	p6_5_4	CHAR(1),
	p6_5_5	CHAR(1),
	p6_6_1	CHAR(1),
	p6_6_2	CHAR(1),
	p6_6_3	CHAR(1),
	p6_6_4	CHAR(1),
	p6_6_5	CHAR(1),
	p6_6_6	CHAR(1),
	p6_6_7	CHAR(1),
	p6_6_8	CHAR(1),
	p6_6_9	CHAR(1),
	filtro_s6_2 CHAR(1),
	p6_7	CHAR(1),
	p6_8	CHAR(1),
	p6_9	CHAR(1),
	p6_10_1	CHAR(1),
	p6_10_2	CHAR(1),
	p6_10_3	CHAR(1),
	p6_10_4	CHAR(1),
	p6_10_5	CHAR(1),
	p6_10_6	CHAR(1),
	p6_10_7	CHAR(1),
	p6_10_8	CHAR(1),
	p6_11_1	CHAR(1),
	p6_11_2	CHAR(1),
	p6_11_3	CHAR(1),
	p6_11_4	CHAR(1),
	p6_11_5	CHAR(1),
	p6_12	NUMERIC,
	p6_13	NUMERIC,
	p7_1	CHAR(1),
	p7_2_1	CHAR(1),
	p7_2_2	CHAR(1),
	p7_2_3	CHAR(1),
	p7_2_4	CHAR(1),
	p7_3	CHAR(1),
	p7_4	CHAR(2),
	p7_5_1	CHAR(1),
	p7_5_2	CHAR(1),
	p7_5_3	CHAR(1),
	p7_5_4	CHAR(1),
	p7_5_5	CHAR(1),
	p7_5_6	CHAR(1),
	p7_6_1	CHAR(1),
	p7_6_2	CHAR(1),
	p7_6_3	CHAR(1),
	p7_6_4	CHAR(1),
	p7_6_5	CHAR(1),
	p7_6_6	CHAR(1),
	p7_6_7	CHAR(1),
	p7_6_8	CHAR(1),
	p7_7_1	CHAR(1),
	p7_7_2	CHAR(1),
	p7_7_3	CHAR(1),
	p7_7_4	CHAR(1),
	p7_7_5	CHAR(1),
	p7_7_6	CHAR(1),
	p7_8_1	CHAR(1),
	p7_8_2	CHAR(1),
	p7_8_3	CHAR(1),
	p7_8_4	CHAR(1),
	p7_8_5	CHAR(1),
	p7_8_6	CHAR(1),
	p7_9_1	CHAR(1),
	p7_9_2	CHAR(1),
	p7_9_3	CHAR(1),
	p7_10_01 CHAR(1),
	p7_10_02 CHAR(1),
	p7_10_03 CHAR(1),
	p7_10_04 CHAR(1),
	p7_10_05 CHAR(1),
	p7_10_06 CHAR(1),
	p7_10_07 CHAR(1),
	p7_10_08 CHAR(1),
	p7_10_09 CHAR(1),
	p7_10_10 CHAR(1),
	p7_10_11 CHAR(1),
	p7_10_12 CHAR(1),
	p7_11_1	CHAR(1),
	p7_11_2	CHAR(1),
	p7_11_3	CHAR(1),
	p7_11_4	CHAR(1),
	p7_12_1	CHAR(1),
	p7_12_2	CHAR(1),
	p7_12_3	CHAR(1),
	p7_12_4	CHAR(1),
	p7_12_5	CHAR(1),
	p7_12_6	CHAR(1),
	p8_1_1	CHAR(1),
	p8_1_2	CHAR(1),
	p8_1_3	CHAR(1),
	p8_1_4	CHAR(1),
	p8_1_5	CHAR(1),
	p8_1_6	CHAR(1),
	p8_2_1	CHAR(1),
	p8_2_2	CHAR(1),
	p8_2_3	CHAR(1),
	p8_2_4	CHAR(1),
	p8_3_01	CHAR(1),
	p8_3_02	CHAR(1),
	p8_3_03	CHAR(1),
	p8_3_04	CHAR(1),
	p8_3_05	CHAR(1),
	p8_3_06	CHAR(1),
	p8_3_07	CHAR(1),
	p8_3_08	CHAR(1),
	p8_3_09	CHAR(1),
	p8_3_10	CHAR(1),
	p8_4	CHAR(2),
	p8_5_1	CHAR(1),
	p8_5_2	CHAR(1),
	p8_5_3	CHAR(1),
	p8_5_4	CHAR(1),
	p8_5_5	CHAR(1),
	p8_5_6	CHAR(1),
	p8_5_7	CHAR(1),
	p8_5_8	CHAR(1),
	p8_5_9	CHAR(1),
	p8_6_01	CHAR(1),
	p8_6_02	CHAR(1),
	p8_6_03	CHAR(1),
	p8_6_04	CHAR(1),
	p8_6_05	CHAR(1),
	p8_6_06	CHAR(1),
	p8_6_07	CHAR(1),
	p8_6_08	CHAR(1),
	p8_6_09	CHAR(1),
	p8_6_10	CHAR(1),
	p8_6_11	CHAR(1),
	p9_1	CHAR(2),
	p9_2	CHAR(1),
	p9_3_1	CHAR(1),
	p9_3_2	CHAR(1),
	p9_3_3	CHAR(1),
	p9_3_4	CHAR(1),
	p9_3_5	CHAR(1),
	p9_3_6	CHAR(1),
	p9_3_7	CHAR(1),
	p10_1	CHAR(1),
	p10_2	CHAR(1),
	p10_3	CHAR(1),
	p10_4_1	CHAR(1),
	p10_4_2	CHAR(1),
	p10_4_3	CHAR(1),
	p10_4_4	CHAR(1),
	p10_4_5	CHAR(1),
	p10_4_6	CHAR(1),
	upm	VARCHAR(100),
	viv_sel	CHAR(2),
	hogar	CHAR(1),
	n_ren	CHAR(2),
	ent	CHAR(2),
	mun	CHAR(3),
	tloc	CHAR(1),
	region	CHAR(1),
	sexo	CHAR(1),
	niv_bienes CHAR(1),
	ingreso_m NUMERIC,
	niv_estres CHAR(1),
	salario_ent CHAR(1),
	sal_min_rp CHAR(1),
	sal_min_zf CHAR(1),
	conf_finan CHAR(1),
	gra_control CHAR(1),
	orien_fut CHAR(1),
	impulsivid CHAR(1),
	orien_acci CHAR(1),
	optimismo CHAR(1),
	gtos_ahorr CHAR(1),
	depen_sum NUMERIC,
	dep_eco	CHAR(1),
	fac_ele	NUMERIC,
	upm_dis	VARCHAR(100),
	est_dis	VARCHAR(100),

CONSTRAINT fk_modulo_vivienda 
       		FOREIGN KEY (llaveviv)
       		REFERENCES tvivienda(llaveviv),

	CONSTRAINT fk_modulo_hogar 
       		FOREIGN KEY (llavehog)
       		REFERENCES thogar(llavehog)

);


--ENTIDAD
--   ↓
--MUNICIPIO
--   ↓
--TVIVIENDA (llaveviv, ent_mun)
--   ↓
--THOGAR   (llavehog, llaveviv)
--   ↓
--TSDEM (llavesde, llavehog, llaveviv) - TMODULO   (llavemod, llavehog, llaveviv)
